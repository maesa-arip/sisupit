import{r as l,j as e,m as k,$ as C}from"./app-C_qzrboB.js";import{H as L}from"./HeaderTitle-VbUwsmrP.js";import{I as i}from"./InputError-CLy03air.js";import{B as f,f as N}from"./button-DLkqQvYF.js";import{C as I,a as S}from"./card-hhIqgVtK.js";import{I as g}from"./input-BRxx6CPH.js";import{L as n}from"./label-IO5Crbii.js";import{T as j}from"./textarea-BYTQO76r.js";import{A}from"./AppLayout-DOIZH9FA.js";import{u as E}from"./index-D7Tq3p3t.js";import{I as P}from"./IconBuildingCommunity-BOsyqTVQ.js";import{I as R}from"./IconArrowLeft-CY25hXJ9.js";import"./index-CfHMBPIY.js";import"./ApplicationLogo-Cjqc7zk6.js";import"./createReactComponent-B5ELgMpc.js";import"./ThemeSwitcher-CrrVxxyG.js";import"./check-DWXs2GqJ.js";const z=()=>{const a=l.useRef(null);return l.useEffect(()=>{if(!window.L){console.error("Leaflet belum dimuat dari CDN.");return}navigator.geolocation?navigator.geolocation.getCurrentPosition(t=>{const{latitude:c,longitude:m}=t.coords;console.log(t.coords);const r=window.L.map(a.current).setView([c,m],13);window.L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}).addTo(r),window.L.marker([c,m]).addTo(r).bindPopup("Lokasi Anda").openPopup()},t=>{console.error("Gagal mendapatkan lokasi:",t)}):alert("Geolocation tidak didukung browser ini")},[]),e.jsxs("div",{children:[e.jsx("h2",{children:"Peta Lokasi Anda"}),e.jsx("div",{id:"map",ref:a,style:{width:"100%",height:"500px",borderRadius:"5px",zIndex:0,position:"relative"}})]})};function B(a){a.auth.user;const[t,c]=l.useState(null),m=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(o=>{const{latitude:x,longitude:d}=o.coords;c({latitude:x,longitude:d})},o=>{console.error("Error getting user location:",o)}):console.error("Geolocation is not supported by this browser.")};l.useEffect(()=>{m()},[]),l.useEffect(()=>{t&&(u("location_lat",t.latitude),u("location_lng",t.longitude))},[t]);const r=l.useRef(null),{data:p,setData:u,reset:v,post:b,processing:w,errors:s}=k({name:"",address:"",title:"",description:"",location_lat:"",location_lng:"",phone:"",photo:null,_method:a.page_settings.method});console.log(p);const h=o=>u(o.target.name,o.target.value),y=o=>{o.preventDefault(),b(a.page_settings.action,{preserveScroll:!0,preserveState:!0,onSuccess:x=>{const d=N(x);d&&E[d.type](d.message)}})},_=()=>{v(),r.current.value=null};return e.jsxs("div",{className:"flex flex-col w-full pb-32",children:[e.jsxs("div",{className:"flex flex-col items-start justify-between mb-8 gap-y-4 lg:flex-row lg:items-center",children:[e.jsx(L,{title:a.page_settings.title,subtitle:a.page_settings.subtitle,icon:P}),e.jsx(f,{variant:"orange",size:"sm",asChild:!0,children:e.jsxs(C,{href:route("dashboard"),children:[e.jsx(R,{className:"size-4"}),"Kembali"]})})]}),e.jsx(I,{children:e.jsx(S,{className:"p-6",children:e.jsxs("form",{className:"space-y-6",onSubmit:y,children:[t&&e.jsxs("div",{children:[e.jsx("h2",{children:"User Location"}),e.jsxs("p",{children:["Latitude: ",t.latitude]}),e.jsxs("p",{children:["Longitude: ",t.longitude]})]}),e.jsx(z,{}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(n,{htmlFor:"location_lat",children:"location_lat"}),e.jsx(g,{name:"location_lat",id:"location_lat",value:t==null?void 0:t.latitude,type:"text",readOnly:!0}),s.location_lat&&e.jsx(i,{message:s.location_lat})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(n,{htmlFor:"location_lng",children:"location_lng"}),e.jsx(g,{name:"location_lng",id:"location_lng",value:t==null?void 0:t.longitude,type:"text",readOnly:!0}),s.location_lng&&e.jsx(i,{message:s.location_lng})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(n,{htmlFor:"title",children:"Judul (Kebakaran/Bencana Alam, dll)"}),e.jsx(g,{name:"title",id:"title",value:p.title,type:"text",placeholder:"Masukan keterangan judul laporan...",onChange:h}),s.title&&e.jsx(i,{message:s.title})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(n,{htmlFor:"description",children:"Deskrisp(Boleh Kosong)"}),e.jsx(j,{name:"description",id:"description",value:p.description,placeholder:"Masukan deskripsi kejadian...",onChange:h}),s.description&&e.jsx(i,{message:s.description})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(n,{htmlFor:"address",children:"Alamat(Boleh Kosong, akan diambil dari lokasi anda berada)"}),e.jsx(j,{name:"address",id:"address",value:p.address,placeholder:"Masukan alamat...",onChange:h}),s.address&&e.jsx(i,{message:s.address})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(n,{htmlFor:"photo",children:"Photo"}),e.jsx(g,{name:"photo",id:"photo",type:"file",ref:r,onChange:o=>u(o.target.name,o.target.files[0])}),s.photo&&e.jsx(i,{message:s.photo})]}),e.jsxs("div",{className:"flex justify-end gap-x-2",children:[e.jsx(f,{type:"button",variant:"secondary",size:"sm",onClick:_,children:"Reset"}),e.jsx(f,{type:"submit",variant:"orange",size:"sm",disabled:w,children:"Save"})]})]})})})]})}B.layout=a=>e.jsx(A,{children:a,title:a.props.page_settings.title});export{B as default};
