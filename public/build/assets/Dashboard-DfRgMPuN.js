import{j as e,r as d,a as H,$ as M,S as B}from"./app-wzyci9oG.js";import{H as I}from"./HeaderTitle-Bvhyx5jR.js";import{A as p,b as f,c as k,d as y,e as w,f as N,h as v,a as S,g as T}from"./alert-dialog-LBJ6ptBJ.js";import{I as R,a as z}from"./InstallPWAButton-B4F6-ZtV.js";import{B as P}from"./badge-C20LGpQl.js";import{B as o}from"./button-CnXJSKQP.js";import{C as g,c as $,d as U,e as E,a as F,b as j}from"./card-DDkjpxrR.js";import{D as b,d as C,e as D,f as A,g as K,h as q,A as G}from"./AppLayout-BKh2QZhm.js";import{u as c}from"./index-DCGLRNFq.js";import{c as x}from"./check-CzEoZsEc.js";import{c as O}from"./createReactComponent-BVKIHPnW.js";import"./index-Cqri6aUO.js";import"./ThemeSwitcher-v5j79v1n.js";import"./ApplicationLogo-DkwJsCY0.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],Y=x("Clock",W);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Q=x("MapPin",J);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],X=x("TriangleAlert",V);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ee=x("User",Z);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],se=x("Users",ae);/**
 * @license @tabler/icons-react v3.30.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var te=O("outline","send","IconSend",[["path",{d:"M10 14l11 -11",key:"svg-0"}],["path",{d:"M21 3l-6.5 18a.55 .55 0 0 1 -1 0l-3.5 -7l-7 -3.5a.55 .55 0 0 1 0 -1l18 -6.5",key:"svg-1"}]]);function le({open:a,onConfirm:i}){return e.jsx(p,{open:a,children:e.jsxs(f,{children:[e.jsxs(k,{children:[e.jsx(y,{children:"Profil Belum Lengkap"}),e.jsx(w,{children:"Silakan lengkapi profil Anda terlebih dahulu dengan mengisi nomor HP dan foto KTP."})]}),e.jsx(N,{children:e.jsx(v,{onClick:i,children:"Isi Sekarang"})})]})})}function ne({open:a,onClose:i,helper:s,onBack:t}){var r,l,n;return e.jsx(b,{open:a,onOpenChange:i,children:e.jsxs(C,{children:[e.jsx(D,{children:e.jsx(A,{children:"Detail Relawan"})}),s&&e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Nama:"})," ",(r=s.user)==null?void 0:r.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",(l=s.user)==null?void 0:l.email]}),e.jsxs("p",{children:[e.jsx("strong",{children:"No HP:"})," ",(n=s.user)==null?void 0:n.phone]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Lokasi:"})," ",s.location_lat,", ",s.location_lng]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Bergabung:"})," ",s.created_at]})]}),e.jsxs(K,{className:"flex justify-between mt-4",children:[e.jsx(o,{variant:"outline",onClick:t,children:"Kembali ke Daftar Relawan"}),e.jsx(o,{onClick:i,children:"Tutup"})]})]})})}function ie({open:a,onClose:i,helpers:s,onSelect:t}){return e.jsx(b,{open:a,onOpenChange:i,children:e.jsxs(C,{children:[e.jsx(D,{children:e.jsx(A,{children:"Daftar Relawan"})}),e.jsx("ul",{className:"mt-2 space-y-2",children:s.map((r,l)=>{var n;return e.jsx("li",{onClick:()=>t(r),className:"cursor-pointer hover:text-blue-600",children:(n=r.user)==null?void 0:n.name},l)})})]})})}function re({reportId:a,onSuccess:i}){const[s,t]=d.useState(!1),r=()=>{if(console.log(a),t(!0),!navigator.geolocation){c.error("Browser Anda tidak mendukung lokasi."),t(!1);return}navigator.geolocation.getCurrentPosition(async l=>{var n;try{await H.post(route("front.helpers.store"),{report_id:a,location_lat:l.coords.latitude,location_lng:l.coords.longitude}),c.success("Berhasil menjadi relawan!"),i==null||i()}catch(m){((n=m.response)==null?void 0:n.status)===409?c.warning("Anda sudah mendaftar sebagai relawan."):c.error("Gagal menyimpan data relawan.")}finally{t(!1)}},l=>{c.error("Gagal mendapatkan lokasi: "+l.message),t(!1)})};return e.jsxs(p,{children:[e.jsx(S,{asChild:!0,children:e.jsx(o,{variant:"destructive",className:"w-full",children:"Saya Akan Membantu"})}),e.jsxs(f,{children:[e.jsxs(k,{children:[e.jsx(y,{children:"Apakah Anda Yakin Ingin Membantu?"}),e.jsx(w,{children:"Lokasi Anda akan dikirim ke server untuk membantu petugas melacak posisi Anda saat menuju lokasi kejadian. Lanjutkan?"})]}),e.jsxs(N,{children:[e.jsx(T,{children:"Batal"}),e.jsx(v,{onClick:r,disabled:s,children:s?"Mengirim...":"Konfirmasi"})]})]})]})}function oe({report:a,onHelpClick:i}){var h,u;const[s,t]=d.useState(!1),[r,l]=d.useState(null),n=L=>{l(L),t(!1)},m=()=>{l(null),t(!0)},_=`https://www.google.com/maps/dir/?api=1&destination=${a.location_lat},${a.location_lng}`;return e.jsxs(g,{className:"border shadow-sm rounded-2xl border-muted",children:[e.jsxs($,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(U,{className:"flex items-center gap-2 text-lg text-destructive",children:[e.jsx(X,{size:20})," ",a.title]}),e.jsx(P,{variant:"outline",children:"Laporan"})]}),e.jsxs(E,{className:"flex items-center gap-2 mt-1 text-sm text-muted-foreground",children:[e.jsx(Y,{size:14})," ",a.created_at]})]}),e.jsxs(F,{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Q,{size:14})," ",a.address]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(ee,{size:14})," ",(h=a.user)==null?void 0:h.name]}),e.jsx("p",{className:"text-foreground",children:a.description}),e.jsxs("div",{className:"flex items-center gap-2 pt-2 text-xs italic text-muted-foreground",children:[((u=a.helpers)==null?void 0:u.length)>0?e.jsxs(o,{className:"w-full",variant:"outline",onClick:()=>t(!0),children:["Lihat ",a.helpers.length," Relawan"]}):e.jsxs(e.Fragment,{children:[e.jsx(se,{size:14})," Status bantuan: Belum ada relawan"]}),e.jsx(ie,{open:s,onClose:()=>t(!1),helpers:a.helpers,onSelect:n}),e.jsx(ne,{open:!!r,onClose:()=>l(null),onBack:m,helper:r})]}),e.jsx("div",{className:"flex items-center gap-2 pt-2 text-xs italic text-muted-foreground",children:e.jsx(g,{children:e.jsx("img",{className:"rounded",src:a.photo,alt:""})})})]}),e.jsx(j,{children:e.jsx("a",{href:_,className:"w-full",target:"_blank",rel:"noopener noreferrer",children:e.jsxs(o,{className:"w-full mr-1",children:[e.jsx(te,{className:"size-4"}),"Lihat di Maps"]})})}),e.jsx(j,{children:e.jsx(re,{reportId:a.id})})]})}function ce(a){const i=a.auth.user,[s,t]=d.useState(!1);d.useEffect(()=>{i.phone||t(!0)},[i]);const r=()=>{B.visit(route("profile.edit"))},l=n=>{console.log("Relawan akan bantu laporan ID:",n)};return e.jsxs("div",{className:"flex flex-col w-full pb-32 space-y-4",children:[e.jsx("div",{className:"flex flex-col items-start justify-between gap-y-4 lg:flex-row lg:items-center",children:e.jsx(I,{title:a.page_settings.title,subtitle:a.page_settings.subtitle,icon:q})}),e.jsx(le,{open:s,onConfirm:r}),e.jsx(o,{variant:"red",className:"relative flex items-center justify-center w-56 h-56 mx-auto overflow-hidden text-lg font-extrabold text-white transition-transform duration-300 rounded-full shadow-2xl animate-pulse bg-gradient-to-br from-red-500 to-red-700 ring-4 ring-red-400/40 hover:scale-105",asChild:!0,children:e.jsxs(M,{href:route("front.reports.create"),children:[e.jsx(R,{className:"absolute text-white/30",style:{width:"200px",height:"200px"}}),e.jsxs("span",{className:"relative z-10 leading-tight tracking-wide text-center uppercase",children:["Laporkan ",e.jsx("br",{})," Kejadian"]})]})}),e.jsx("hr",{className:"my-6"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Laporan Terbaru"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Laporan kejadian yang membutuhkan bantuan"}),a.page_data.reports.length===0?e.jsx("p",{className:"italic text-muted-foreground",children:"Belum ada laporan aktif saat ini."}):e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:a.page_data.reports.map(n=>e.jsx(oe,{report:n,onHelpClick:l},n.id))})]}),e.jsx("hr",{className:"my-6"}),e.jsx("div",{className:"flex flex-col justify-between w-full gap-2 lg:flex-row"}),e.jsx("div",{className:"mt-6",children:e.jsx(z,{})})]})}ce.layout=a=>e.jsx(G,{children:a,title:"Dashboard"});export{ce as default};
