import{r as d,j as e,m as k,$ as C}from"./app-DgcaxKz2.js";import{H as N}from"./HeaderTitle-CdAVtfIh.js";import{I as n}from"./InputError-vrwQIKkn.js";import{B as f,f as L}from"./button-BNYPSzHz.js";import{C as I,a as F}from"./card-BEEA5XH2.js";import{I as r}from"./input-sngfz9og.js";import{L as i}from"./label-BK-JNoob.js";import{T as j}from"./textarea-DO2z2le3.js";import{A as M}from"./AppLayout-BQUI4X09.js";import{u as S}from"./index-DTvZtZaw.js";import{I as A}from"./IconBuildingCommunity-DqMGNePD.js";import{I as E}from"./IconArrowLeft-3teyAXmr.js";import"./index-IVsOhHNO.js";import"./ApplicationLogo-CEz_rgHt.js";import"./createReactComponent-l8W9ONTd.js";import"./NavLinkResponsive-IFX3MRy_.js";import"./check-Cto1SBsn.js";import"./ThemeSwitcher-DUjg8DtY.js";const P=()=>{const o=d.useRef(null);return d.useEffect(()=>{if(!window.L){console.error("Leaflet belum dimuat dari CDN.");return}navigator.geolocation?navigator.geolocation.getCurrentPosition(t=>{const{latitude:u,longitude:g}=t.coords;console.log(t.coords);const c=window.L.map(o.current).setView([u,g],13);window.L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}).addTo(c),window.L.marker([u,g]).addTo(c).bindPopup("Lokasi Anda").openPopup()},t=>{console.error("Gagal mendapatkan lokasi:",t)}):alert("Geolocation tidak didukung browser ini")},[]),e.jsxs("div",{children:[e.jsx("h2",{children:"Peta Lokasi Anda"}),e.jsx("div",{id:"map",ref:o,style:{width:"100%",height:"500px",borderRadius:"5px",zIndex:0,position:"relative"}})]})};function R(o){const[t,u]=d.useState(null),g=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(s=>{const{latitude:x,longitude:p}=s.coords;u({latitude:x,longitude:p})},s=>{console.error("Error getting user location:",s)}):console.error("Geolocation is not supported by this browser.")};d.useEffect(()=>{g()},[]),d.useEffect(()=>{t&&(h("location_lat",t.latitude),h("location_lng",t.longitude))},[t]);const c=d.useRef(null),{data:l,setData:h,reset:v,post:b,processing:w,errors:a}=k({name:"",address:"",title:"",description:"",location_lat:"",location_lng:"",phone:"",photo:null,_method:o.page_settings.method});console.log(l);const m=s=>h(s.target.name,s.target.value),y=s=>{s.preventDefault(),b(o.page_settings.action,{preserveScroll:!0,preserveState:!0,onSuccess:x=>{const p=L(x);p&&S[p.type](p.message)}})},_=()=>{v(),c.current.value=null};return e.jsxs("div",{className:"flex flex-col w-full pb-32",children:[e.jsxs("div",{className:"flex flex-col items-start justify-between mb-8 gap-y-4 lg:flex-row lg:items-center",children:[e.jsx(N,{title:o.page_settings.title,subtitle:o.page_settings.subtitle,icon:A}),e.jsx(f,{variant:"orange",size:"sm",asChild:!0,children:e.jsxs(C,{href:route("dashboard"),children:[e.jsx(E,{className:"size-4"}),"Kembali"]})})]}),e.jsx(I,{children:e.jsx(F,{className:"p-6",children:e.jsxs("form",{className:"space-y-6",onSubmit:y,children:[t&&e.jsxs("div",{children:[e.jsx("h2",{children:"User Location"}),e.jsxs("p",{children:["Latitude: ",t.latitude]}),e.jsxs("p",{children:["Longitude: ",t.longitude]})]}),e.jsx(P,{}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(i,{htmlFor:"location_lat",children:"location_lat"}),e.jsx(r,{name:"location_lat",id:"location_lat",value:t==null?void 0:t.latitude,type:"text",readOnly:!0}),a.location_lat&&e.jsx(n,{message:a.location_lat})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(i,{htmlFor:"location_lng",children:"location_lng"}),e.jsx(r,{name:"location_lng",id:"location_lng",value:t==null?void 0:t.longitude,type:"text",readOnly:!0}),a.location_lng&&e.jsx(n,{message:a.location_lng})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(i,{htmlFor:"name",children:"Nama"}),e.jsx(r,{name:"name",id:"name",value:l.name,type:"text",placeholder:"Masukan nama...",onChange:m}),a.name&&e.jsx(n,{message:a.name})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(i,{htmlFor:"phone",children:"Nomor Telp"}),e.jsx(r,{name:"phone",id:"phone",value:l.phone,type:"text",placeholder:"Masukan nomor telp...",onChange:m}),a.phone&&e.jsx(n,{message:a.phone})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(i,{htmlFor:"title",children:"Judul (Kebakaran/Bencana Alam, dll)"}),e.jsx(r,{name:"title",id:"title",value:l.title,type:"text",placeholder:"Masukan keterangan judul laporan...",onChange:m}),a.title&&e.jsx(n,{message:a.title})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(i,{htmlFor:"description",children:"Deskrisp(Boleh Kosong)"}),e.jsx(j,{name:"description",id:"description",value:l.description,placeholder:"Masukan deskripsi kejadian...",onChange:m}),a.description&&e.jsx(n,{message:a.description})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(i,{htmlFor:"address",children:"Alamat(Boleh Kosong, akan diambil dari lokasi anda berada)"}),e.jsx(j,{name:"address",id:"address",value:l.address,placeholder:"Masukan alamat...",onChange:m}),a.address&&e.jsx(n,{message:a.address})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(i,{htmlFor:"photo",children:"Photo"}),e.jsx(r,{name:"photo",id:"photo",type:"file",ref:c,onChange:s=>h(s.target.name,s.target.files[0])}),a.photo&&e.jsx(n,{message:a.photo})]}),e.jsxs("div",{className:"flex justify-end gap-x-2",children:[e.jsx(f,{type:"button",variant:"secondary",size:"sm",onClick:_,children:"Reset"}),e.jsx(f,{type:"submit",variant:"orange",size:"sm",disabled:w,children:"Save"})]})]})})})]})}R.layout=o=>e.jsx(M,{children:o,title:o.props.page_settings.title});export{R as default};
